(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5900:function(n,e,t){Promise.resolve().then(t.bind(t,217))},217:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return nR}});var r=t(7904),i=t(4725),o=t(3807),a=t(2260),l=t(9611),u=t(8313),c={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function s(n){var e=function(n){if("number"==typeof n)return{value:n,unit:"px"};var e,t=(n.match(/^[0-9.]*/)||"").toString();e=t.includes(".")?parseFloat(t):parseInt(t,10);var r=(n.match(/[^0-9]*$/)||"").toString();return c[r]?{value:e,unit:r}:{value:e,unit:"px"}}(n);return"".concat(e.value).concat(e.unit)}var d=function(){return(d=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n}).apply(this,arguments)},f=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&0>e.indexOf(r)&&(t[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)0>e.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t},m=function(n,e,t){var r="react-spinners-".concat(n,"-").concat(t);if(!window.document)return r;var i=document.createElement("style");document.head.appendChild(i);var o=i.sheet,a="\n    @keyframes ".concat(r," {\n      ").concat(e,"\n    }\n  ");return o&&o.insertRule(a,0),r}("ClipLoader","0% {transform: rotate(0deg) scale(1)} 50% {transform: rotate(180deg) scale(0.8)} 100% {transform: rotate(360deg) scale(1)}","clip"),p=function(n){var e=n.loading,t=n.color,r=void 0===t?"#000000":t,o=n.speedMultiplier,a=n.cssOverride,l=n.size,u=void 0===l?35:l,c=f(n,["loading","color","speedMultiplier","cssOverride","size"]),p=d({background:"transparent !important",width:s(u),height:s(u),borderRadius:"100%",border:"2px solid",borderTopColor:r,borderBottomColor:"transparent",borderLeftColor:r,borderRightColor:r,display:"inline-block",animation:"".concat(m," ").concat(.75/(void 0===o?1:o),"s 0s infinite linear"),animationFillMode:"both"},void 0===a?{}:a);return void 0===e||e?i.createElement("span",d({style:p},c)):null};function h(n){let{categories:e=[],value:t,onChange:i,disabled:o}=n;return(0,r.jsxs)("select",{value:null!=t?t:"",onChange:n=>i(n.target.value?Number(n.target.value):null),disabled:o,style:{width:"100%",padding:"0.7rem",borderRadius:8,border:"1px solid #e5e7eb",marginTop:4,marginBottom:"1rem"},children:[(0,r.jsx)("option",{value:"",children:"카테고리 선택"}),e.map(n=>(0,r.jsx)("option",{value:n.id,children:n.name},n.id))]})}function g(){let n=(0,a._)(["\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n"]);return g=function(){return n},n}function b(){let n=(0,a._)(["\n  background: white;\n  padding: 2rem;\n  border-radius: 1.5rem;\n  width: 90%;\n  max-width: 400px;\n  box-shadow: 0 4px 24px 0 rgba(0,0,0,0.08);\n  box-sizing: border-box;\n"]);return b=function(){return n},n}function x(){let n=(0,a._)(["\n  font-size: 1.5rem;\n  font-weight: 700;\n  margin-bottom: 1.5rem;\n  color: #222;\n"]);return x=function(){return n},n}function v(){let n=(0,a._)(["\n  width: 100%;\n  padding: 1rem;\n  border: 1px solid #e5e7eb;\n  border-radius: 0.75rem;\n  font-size: 1rem;\n  margin-bottom: 1rem;\n  box-sizing: border-box;\n  &:focus {\n    outline: none;\n    border-color: #3b82f6;\n  }\n"]);return v=function(){return n},n}function y(){let n=(0,a._)(["\n  display: flex;\n  justify-content: flex-end;\n  gap: 1rem;\n  margin-top: 1.5rem;\n"]);return y=function(){return n},n}function w(){let n=(0,a._)(["\n  padding: 0.75rem 1.5rem;\n  border-radius: 0.75rem;\n  font-size: 1rem;\n  font-weight: 600;\n  cursor: pointer;\n  border: none;\n  transition: all 0.2s;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5rem;\n  min-width: 100px;\n\n  ","\n"]);return w=function(){return n},n}function j(){let n=(0,a._)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5rem;\n"]);return j=function(){return n},n}let k=u.ZP.div(g()),P=u.ZP.div(b()),_=u.ZP.h2(x()),O=u.ZP.input(v()),Z=u.ZP.div(y()),S=u.ZP.button(w(),n=>{let{$variant:e}=n;return"primary"===e?"\n        background: #3b82f6;\n        color: white;\n        &:hover {\n          background: #2563eb;\n        }\n        &:disabled {\n          background: #93c5fd;\n          cursor: not-allowed;\n        }\n      ":"\n      background: #f3f4f6;\n      color: #4b5563;\n      &:hover {\n        background: #e5e7eb;\n      }\n      &:disabled {\n        background: #f3f4f6;\n        cursor: not-allowed;\n      }\n    "}),E=u.ZP.div(j());function C(n){var e,t,o;let{poll:a,onClose:l,onSave:u}=n,[c,s]=(0,i.useState)(a.question),[d,f]=(0,i.useState)(null!==(o=null===(e=a.categories)||void 0===e?void 0:e.id)&&void 0!==o?o:null),[m,g]=(0,i.useState)(!1);i.useEffect(()=>{var n,e;f(null!==(e=null===(n=a.categories)||void 0===n?void 0:n.id)&&void 0!==e?e:null)},[null===(t=a.categories)||void 0===t?void 0:t.id]);let b=async()=>{if(!c.trim()){alert("질문을 입력해주세요.");return}if(!d){alert("카테고리를 선택해주세요.");return}g(!0);try{await u({...a,question:c},d),l()}catch(n){alert("수정에 실패했습니다. 다시 시도해주세요.")}finally{g(!1)}};return(0,r.jsx)(k,{onClick:l,children:(0,r.jsxs)(P,{onClick:n=>n.stopPropagation(),children:[(0,r.jsx)(_,{children:"투표 수정"}),(0,r.jsx)(h,{value:d,onChange:f,disabled:m}),(0,r.jsx)(O,{type:"text",value:c,onChange:n=>s(n.target.value),placeholder:"질문을 입력하세요",disabled:m}),(0,r.jsxs)(Z,{children:[(0,r.jsx)(S,{onClick:l,disabled:m,children:"취소"}),(0,r.jsx)(S,{$variant:"primary",onClick:b,disabled:m,children:m?(0,r.jsxs)(E,{children:[(0,r.jsx)(p,{size:16,color:"#ffffff"}),(0,r.jsx)("span",{children:"저장 중..."})]}):"저장"})]})]})})}var z=t(4889),N=t(618);function D(){let n=(0,a._)(["\n  min-height: 100vh;\n  background: #f6f8fa;\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  margin-top: 0;\n"]);return D=function(){return n},n}function T(){let n=(0,a._)(["\n  width: 100%;\n  max-width: 420px;\n  margin: 0 auto;\n  padding: 0 0.5rem 2rem 0.5rem;\n  background: transparent;\n  border-radius: 0;\n  box-shadow: none;\n  @media (max-width: 480px) {\n    max-width: 100vw;\n    padding: 0 0.2rem 2rem 0.2rem;\n  }\n"]);return T=function(){return n},n}function A(){let n=(0,a._)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1.2rem;\n  min-width: 300px; // ← 원하는 값으로 변경\n\n"]);return A=function(){return n},n}function R(){let n=(0,a._)(["\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  min-width: 240px; // ← 원하는 값으로 변경\n"]);return R=function(){return n},n}function I(){let n=(0,a._)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  min-height: 100vh;\n  width: 100%;\n  background: #f6f8fa;\n"]);return I=function(){return n},n}function B(){let n=(0,a._)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0.5rem;\n  min-width: 240px; // ← 원하는 값으로 변\n"]);return B=function(){return n},n}function F(){let n=(0,a._)(["\n  display: flex;\n  gap: 1rem;\n  justify-content: center;\n  margin-bottom: 1.5rem;\n  flex-wrap: wrap;\n"]);return F=function(){return n},n}function V(){let n=(0,a._)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-top: 0.5rem;\n"]);return V=function(){return n},n}function K(){let n=(0,a._)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5rem;\n"]);return K=function(){return n},n}function L(){let n=(0,a._)(["\n  width: 100%;\n  height: 80px;\n  background:rgb(216, 216, 216);\n  border-radius: 1rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color:rgb(255, 255, 255);\n  font-size: 1.2rem;\n  font-weight: 600;\n  margin-bottom: 1.2rem;\n"]);return L=function(){return n},n}function M(){let n=(0,a._)(["\n  color: #a3a3a3;\n  background: none;\n  border: none;\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 50%;\n  transition: background 0.15s;\n  &:hover {\n    background: #f3f4f6;\n  }\n"]);return M=function(){return n},n}function $(){let n=(0,a._)(["\n  position: absolute;\n  top: 2.2rem;\n  right: 0.5rem;\n  background: #fff;\n  border-radius: 1rem;\n  box-shadow: 0 4px 16px 0 rgba(0,0,0,0.10);\n  min-width: 120px;\n  z-index: 10;\n  padding: 0.5rem 0;\n"]);return $=function(){return n},n}function q(){let n=(0,a._)(["\n  width: 100%;\n  background: none;\n  border: none;\n  color: #ffffff;\n  font-size: 1rem;\n  padding: 0.7rem 1.2rem;\n  text-align: left;\n  cursor: pointer;\n  transition: background 0.15s;\n  &:hover {\n    background: #f3f4f6;\n  }\n"]);return q=function(){return n},n}function H(){let n=(0,a._)(["\n  display: flex;\n  gap: 8px;\n  align-items: center;\n  justify-content: center;\n"]);return H=function(){return n},n}function J(){let n=(0,a._)(["\n  width: 8px;\n  height: 8px;\n  border-radius: 50%;\n  background: #3b82f6;\n  animation: bounce 1.4s infinite ease-in-out;\n\n  &:nth-child(1) {\n    animation-delay: -0.32s;\n  }\n\n  &:nth-child(2) {\n    animation-delay: -0.16s;\n  }\n\n  @keyframes bounce {\n    0%, 80%, 100% {\n      transform: scale(0);\n    }\n    40% {\n      transform: scale(1);\n    }\n  }\n"]);return J=function(){return n},n}function W(){let n=(0,a._)(["\n  display: flex;\n  align-items: center;\n"]);return W=function(){return n},n}function U(){let n=(0,a._)(["\n  gap: 8px;\n"]);return U=function(){return n},n}function X(){let n=(0,a._)(["\n  gap: 12px;\n"]);return X=function(){return n},n}function G(){let n=(0,a._)(["\n  position: relative;\n"]);return G=function(){return n},n}let Q=u.ZP.main(D()),Y=u.ZP.div(T()),nn=u.ZP.div(A()),ne=u.ZP.div(R());u.ZP.div(I());let nt=u.ZP.div(B()),nr=u.ZP.div(F()),ni=u.ZP.div(V()),no=u.ZP.div(K()),na=u.ZP.div(L()),nl=u.ZP.button(M()),nu=u.ZP.div($()),nc=u.ZP.button(q());u.ZP.div(H()),u.ZP.div(J());let ns=u.ZP.div(W()),nd=(0,u.ZP)(ns)(U()),nf=(0,u.ZP)(ns)(X()),nm=u.ZP.div(G());function np(n){if(!n)return"";let e="string"==typeof n?new Date(n):n;return!e||isNaN(e.getTime())?"":e.toLocaleString("ko-KR",{year:"2-digit",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function nh(){let n=(0,a._)(["\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n  margin-top: 1rem;\n"]);return nh=function(){return n},n}function ng(){let n=(0,a._)(["\n  flex: 1;\n"]);return ng=function(){return n},n}function nb(){let n=(0,a._)(["\n  font-weight: 600;\n  margin-left: 0.5rem;\n"]);return nb=function(){return n},n}function nx(){let n=(0,a._)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-top: 1rem;\n  padding-top: 0.5rem;\n  border-top: 1px solid #e5e7eb;\n"]);return nx=function(){return n},n}function nv(){let n=(0,a._)(["\n  color: #6b7280;\n  font-size: 0.9rem;\n"]);return nv=function(){return n},n}function ny(){let n=(0,a._)(["\n  color: #ef4444;\n  font-size: 0.9rem;\n  font-weight: 600;\n"]);return ny=function(){return n},n}function nw(){let n=(0,a._)(["\n  color: #3b82f6;\n  font-size: 0.9rem;\n  font-weight: 600;\n"]);return nw=function(){return n},n}function nj(){let n=(0,a._)(["\n  margin: 0 auto;\n  font-size: 1rem;\n  line-height: 1.4;\n  color: #333;\n  text-align: center;\n  background: #f8f9fa;\n  border: 1px solid #e5e7eb;\n  border-radius: 0.5rem;\n  padding: 0.5rem 1rem;\n  display: inline-block;\n"]);return nj=function(){return n},n}function nk(n){if(!n)return"마감일 미설정";let e="string"==typeof n?new Date(n):n;if(isNaN(e.getTime()))return"마감일 미설정";let t=new Date,r=e.getTime()-t.getTime();return r<=0?"마감":"".concat(Math.floor(r/36e5).toString().padStart(2,"0"),":").concat(Math.floor(r%36e5/6e4).toString().padStart(2,"0"),":").concat(Math.floor(r%6e4/1e3).toString().padStart(2,"0"))}let nP=n=>0===n?"like":1===n?"neutral":"dislike";u.ZP.div(nh()),u.ZP.span(ng()),u.ZP.span(nb()),u.ZP.div(nx()),u.ZP.span(nv()),u.ZP.span(ny()),u.ZP.span(nw());let n_=(0,u.ZP)(N.HN)(nj());function nO(n){var e,t,a,u;let{poll:c,onVote:s,onUpdate:d,onDelete:f,hasVoted:m,disabled:h,isExpanded:g=!1,onExpand:b}=n,{data:x}=(0,o.useSession)(),[v,y]=(0,i.useState)(null),[w,j]=(0,i.useState)(!1),[k,P]=(0,i.useState)(null),[_,O]=(0,i.useState)(!1),[Z,S]=(0,i.useState)(!1),[E,D]=(0,i.useState)(!1);(0,i.useRef)(null);let[T,A]=(0,i.useState)(nk(c.endsAt)),R=(0,i.useRef)(null),I=(null==x?void 0:null===(e=x.user)||void 0===e?void 0:e.email)===c.userEmail,B=null!==(u=null!=m?m:c.hasVoted)&&void 0!==u&&u;(0,i.useEffect)(()=>{},[d,f,I,B]),(0,i.useEffect)(()=>{let n=setInterval(()=>{A(nk(c.endsAt))},1e3);return()=>clearInterval(n)},[c.endsAt]),(0,i.useEffect)(()=>{},[c]),(0,i.useEffect)(()=>{},[c]);let F=async n=>{if(!B){j(!0),y(null);try{await s(n),P(n)}catch(n){y("투표에 실패했습니다. 잠시 후 다시 시도해주세요.")}finally{j(!1)}}},V=(0,i.useCallback)(()=>O(!1),[]),K=(0,i.useCallback)(async n=>{if(d)try{await d(n)}catch(n){alert("투표 수정에 실패했습니다.")}},[d]);return((0,i.useEffect)(()=>{O(!1)},[c.id,f]),(0,i.useEffect)(()=>{},[c.createdAt]),Array.isArray(c.options)?c.options:"string"==typeof c.options&&JSON.parse(c.options),(0,i.useEffect)(()=>{if(_)return document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",n)};function n(n){R.current&&!R.current.contains(n.target)&&O(!1)}},[_]),Z)?null:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(nm,{children:(0,r.jsx)("div",{onClick:b,style:{cursor:"pointer"},children:g?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(nt,{children:[(0,r.jsxs)(nd,{children:[(0,r.jsx)(N.WD,{children:(null===(a=c.categories)||void 0===a?void 0:a.name)||"카테고리 없음"}),(0,r.jsx)(N.u6,{children:"\xb7"}),(0,r.jsx)(N.vb,{children:np(c.createdAt)})]}),(0,r.jsxs)(nm,{onClick:n=>n.stopPropagation(),children:[(0,r.jsx)(nl,{onClick:()=>O(n=>!n),"aria-label":"메뉴 열기",children:(0,r.jsx)(l.EAB,{size:18})}),_&&(0,r.jsx)(nu,{id:"poll-menu-".concat(c.id),ref:R,children:I?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(nc,{onClick:()=>{V(),D(!0)},children:"수정"}),(0,r.jsx)(nc,{onClick:()=>{V(),f(c.id)},children:"삭제"})]}):(0,r.jsx)(nc,{onClick:()=>{S(!0),V()},children:"관심없음"})})]})]}),(0,r.jsx)(N.HN,{children:c.question}),(0,r.jsx)(nr,{children:c.options.map((n,e)=>{let t=c.totalVotes>0?Math.round(n.votes/c.totalVotes*100):0;return(0,r.jsx)(z.yw,{onClick:()=>F(n.id),disabled:B||w,$selected:k===n.id,$disabled:B||w,$type:nP(e),children:w&&k===n.id?(0,r.jsxs)(no,{children:[(0,r.jsx)(p,{size:16,color:"#ffffff"}),(0,r.jsx)("span",{children:"투표 중..."})]}):(0,r.jsxs)(r.Fragment,{children:[n.text,(0,r.jsxs)(N.J7,{children:[t,"%"]})]})},n.id)})}),(0,r.jsxs)(ni,{children:[(0,r.jsxs)(N.IK,{children:["총 ",c.totalVotes,"명 참여"]}),(0,r.jsxs)(nf,{children:[(0,r.jsx)(l.ajU,{color:"#a3a3a3",size:18}),(0,r.jsx)(N.KH,{children:"3"}),(0,r.jsx)(l.PPi,{color:"#a3a3a3",size:18})]})]}),v&&(0,r.jsx)(N.y,{children:v}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:8},children:[(0,r.jsxs)(N._1,{children:["마감일: ",np(c.endsAt)]}),(0,r.jsx)(N.h4,{$closed:"마감"===T,children:T})]})]}):(0,r.jsxs)(n_,{children:[(null===(t=c.categories)||void 0===t?void 0:t.name)?"[".concat(c.categories.name,"] "):"",c.question]})})}),E&&(0,r.jsx)(C,{poll:c,onClose:()=>D(!1),onSave:K})]})}function nZ(){let n=(0,a._)(["\n  width: 100%;\n  background: linear-gradient(90deg, #3b82f6 0%, #60a5fa 100%);\n  color: #fff;\n  font-weight: 800;\n  font-size: 1.1rem;\n  border-radius: 1rem;\n  border: none;\n  box-shadow: 0 2px 8px rgba(59,130,246,0.08);\n  padding: 0.9rem 0;\n  margin-top: 1.2rem;\n  transition: background 0.2s, color 0.2s;\n  &:hover {\n    background: linear-gradient(90deg, #2563eb 0%, #3b82f6 100%);\n    color: #e0e7ef;\n  }\n"]);return nZ=function(){return n},n}let nS=u.ZP.button(nZ());function nE(n){let{onClick:e}=n;return(0,r.jsx)(nS,{onClick:e,children:"더보기"})}var nC=t(8896),nz=t(4213),nN=t(3455);function nD(n){var e;let{loading:t}=n,{data:a,status:l}=(0,o.useSession)(),u=(0,nC.useRouter)(),[c,s]=(0,i.useState)(!1),[d,f]=(0,i.useState)([]),[m,p]=(0,i.useState)(null),[h,g]=(0,i.useState)(3),[b,x]=(0,i.useState)(!1),[v,y]=(0,i.useState)({}),[w,j]=(0,i.useState)(null),k=n=>{s(!0),u.push(n)};(0,i.useEffect)(()=>{P()},[]);let P=async()=>{try{let n=await fetch("/api/polls");if(!n.ok)throw Error("투표 목록을 불러오는데 실패했습니다.");let e=await n.json();f(e)}catch(n){p(n instanceof Error?n.message:"알 수 없는 오류가 발생했습니다.")}},_=async(n,e)=>{try{let t=await fetch("/api/polls/".concat(n.id,"/vote"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({optionId:e})});if(!t.ok)throw Error("투표 실패");let r=await t.json();f(d.map(e=>e.id===n.id?r:e))}catch(n){alert(n instanceof Error?n.message:"알 수 없는 오류가 발생했습니다.")}},O=async n=>{try{let e=await fetch("/api/polls/".concat(n.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!e.ok)throw Error("수정 실패");let t=await e.json();f(d.map(n=>n.id===t.id?t:n))}catch(n){alert(n instanceof Error?n.message:"알 수 없는 오류가 발생했습니다.")}},Z=async n=>{if(window.confirm("정말 삭제하시겠습니까?"))try{if(!(await fetch("/api/polls/".concat(n),{method:"DELETE",credentials:"include"})).ok)throw Error("삭제 실패");f(e=>e.filter(e=>e.id!==n)),y(e=>{let t={...e};return delete t[n],t})}catch(n){alert(n instanceof Error?n.message:"알 수 없는 오류가 발생했습니다.")}};return c?(0,r.jsx)(nz.Z,{}):"loading"===l?null:m?(0,r.jsx)("div",{style:{color:"#ef4444",fontWeight:700},children:m}):(0,r.jsx)(Q,{children:(0,r.jsxs)(Y,{children:[(0,r.jsxs)(nn,{children:[(0,r.jsx)(N.FN,{src:"/2030-logo.png",alt:"2030 로고"}),(0,r.jsx)(ne,{children:(null==a?void 0:null===(e=a.user)||void 0===e?void 0:e.name)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(N.vx,{children:[a.user.name,"님 환영합니다"]}),(0,r.jsx)(z.$m,{onClick:()=>(0,o.signOut)(),children:"로그아웃"})]}):(0,r.jsx)(z.TX,{onClick:()=>k("/auth/signin"),children:"로그인"})})]}),(0,r.jsxs)(nN.Z,{marginBottom:"1.2rem",children:[(0,r.jsx)(na,{children:"광고 배너 영역"}),(0,r.jsx)(N.DK,{children:"2030 세대의 생각을 투표로 확인하세요"})]}),b&&null,(0,r.jsx)(nN.Z,{marginBottom:"1.2rem",children:d.slice(0,h).map((n,e)=>{var t;let i=null===w?0===e:w===n.id,o=(null==a?void 0:null===(t=a.user)||void 0===t?void 0:t.email)===n.userEmail;return(0,r.jsx)("div",{style:{marginBottom:"1.2rem"},children:(0,r.jsx)(nO,{poll:n,isExpanded:i,onExpand:()=>{i||j(n.id)},onVote:e=>_(n,e),onUpdate:o?O:void 0,onDelete:o?Z:void 0,hasVoted:v[n.id],disabled:v[n.id]})},n.id)})}),h<d.length&&(0,r.jsx)(nE,{onClick:()=>{g(n=>n+3)}})]})})}function nT(n){var e,t,r,i,o,a,l,u,c,s;let d;let f=new Date,m=new Date;if(n.ends_at&&"string"==typeof n.ends_at)try{let e=new Date(n.ends_at);isNaN(e.getTime())||(d=e)}catch(n){}if(!d&&n.created_at&&"string"==typeof n.created_at)try{let e=new Date(n.created_at);isNaN(e.getTime())||(d=new Date(e.getTime()+864e5))}catch(n){}let p=null!==(t=n.created_at)&&void 0!==t?t:n.createdAt;if("string"==typeof p){let n=new Date(p);isNaN(n.getTime())||(f=n)}if(n.updated_at&&"string"==typeof n.updated_at)try{let e=new Date(n.updated_at);isNaN(e.getTime())||(m=e)}catch(n){}else m=f;let h=Array.isArray(n.options)?n.options.map(n=>{var e,t;return{id:n.id,text:null!==(e=n.text)&&void 0!==e?e:"",votes:null!==(t=n.votes)&&void 0!==t?t:0}}):[];Array.isArray(n.options);let g=null!==(o=null!==(i=null!==(r=n.user_email)&&void 0!==r?r:n.userEmail)&&void 0!==i?i:null===(e=n.user)||void 0===e?void 0:e.email)&&void 0!==o?o:"";return{id:n.id,question:null!==(a=n.question)&&void 0!==a?a:"질문 없음",options:h,totalVotes:"number"==typeof n.total_votes?n.total_votes:0,createdAt:f.toISOString(),updatedAt:m.toISOString(),endsAt:null!==(l=null==d?void 0:d.toISOString())&&void 0!==l?l:"",userEmail:g,remainTime:null!==(u=n.remain_time)&&void 0!==u?u:"",isClosed:null!==(c=n.is_closed)&&void 0!==c&&c,hasVoted:null!==(s=n.has_voted)&&void 0!==s&&s}}function nA(){let[n,e]=(0,i.useState)([]),[t,a]=(0,i.useState)(!0),[l,u]=(0,i.useState)(null),[c,s]=(0,i.useState)(null),{data:d,status:f}=(0,o.useSession)(),m=(0,nC.useRouter)(),[p,h]=(0,i.useState)(!1);(0,i.useEffect)(()=>{(async()=>{try{var n,e;let t=await fetch("/api/auth/session",{credentials:"include"}).then(n=>n.json());s(null!==(e=null==t?void 0:null===(n=t.user)||void 0===n?void 0:n.email)&&void 0!==e?e:null)}catch(n){}})()},[]),(0,i.useEffect)(()=>{"authenticated"===f&&(null==d?void 0:d.user)&&d.user.isAdmin&&h(!0)},[f,d]);let g=(0,i.useCallback)(async()=>{try{a(!0),u(null);let n=await fetch("/api/polls");if(!n.ok)throw Error("투표 목록을 불러오는데 실패했습니다.");let t=(await n.json()).map(nT);e(t)}catch(n){u(n instanceof Error?n.message:"알 수 없는 오류가 발생했습니다.")}finally{a(!1)}},[]);return((0,i.useEffect)(()=>{g()},[g]),(0,i.useCallback)(async(n,e)=>{try{if(!(await fetch("/api/polls/".concat(n,"/vote"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({optionId:e}),cache:"no-store"})).ok)throw Error("투표에 실패했습니다.");await g()}catch(n){throw n}},[g]),(0,i.useCallback)(async n=>{try{if(!(await fetch("/api/polls/".concat(n.id),{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json","X-DOCORE-DEBUG":"update-poll"},body:JSON.stringify({question:n.question}),cache:"no-store"})).ok)throw Error("투표 수정에 실패했습니다.");await g()}catch(n){throw n}},[g]),(0,i.useCallback)(async n=>{try{if(!(await fetch("/api/polls/".concat(n),{method:"DELETE",credentials:"include",headers:{"X-DOCORE-DEBUG":"delete-poll"},cache:"no-store"})).ok)throw Error("투표 삭제에 실패했습니다.");await g()}catch(n){throw n}},[g]),p)?(0,r.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.3)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:(0,r.jsxs)("div",{style:{background:"#fff",padding:32,borderRadius:12,boxShadow:"0 2px 16px rgba(0,0,0,0.15)"},children:[(0,r.jsxs)("p",{style:{fontWeight:700,fontSize:18,marginBottom:24},children:["관리자 계정입니다.",(0,r.jsx)("br",{}),"어드민 페이지로 접속하시겠습니까?"]}),(0,r.jsx)("button",{onClick:()=>{h(!1),m.push("/admin/polls")},style:{marginRight:16,padding:"8px 20px",fontWeight:600},children:"예, 어드민으로 이동"}),(0,r.jsx)("button",{onClick:()=>{h(!1),m.push("/")},style:{padding:"8px 20px",fontWeight:600},children:"아니오, 일반 사용자로 이동"})]})}):t?(0,r.jsx)(nz.Z,{}):(0,r.jsx)(Q,{children:(0,r.jsx)(Y,{children:(0,r.jsx)(nD,{loading:t})})})}function nR(){return(0,r.jsx)(nA,{})}},4213:function(n,e,t){"use strict";t.d(e,{Z:function(){return f}});var r=t(2260),i=t(7904),o=t(8313);function a(){let n=(0,r._)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  min-height: 100vh;\n  width: 100vw;\n  max-width: none;\n  background: #f6f8fa;\n"]);return a=function(){return n},n}function l(){let n=(0,r._)(["\n  display: flex;\n  gap: 16px;\n  align-items: center;\n  justify-content: center;\n"]);return l=function(){return n},n}function u(){let n=(0,r._)(["\n  width: 16px;\n  height: 16px;\n  border-radius: 50%;\n  background: #3b82f6;\n  animation: bounce 1.4s infinite ease-in-out;\n\n  &:nth-child(1) { animation-delay: -0.32s; }\n  &:nth-child(2) { animation-delay: -0.16s; }\n\n  @keyframes bounce {\n    0%, 80%, 100% { transform: scale(0); }\n    40% { transform: scale(1); }\n  }\n"]);return u=function(){return n},n}let c=o.ZP.div(a()),s=o.ZP.div(l()),d=o.ZP.div(u());function f(){return(0,i.jsx)(c,{children:(0,i.jsxs)(s,{children:[(0,i.jsx)(d,{}),(0,i.jsx)(d,{}),(0,i.jsx)(d,{})]})})}},4889:function(n,e,t){"use strict";t.d(e,{$m:function(){return d},KM:function(){return s},TX:function(){return f},yw:function(){return m}});var r=t(2260),i=t(8313);function o(){let n=(0,r._)(["\n  padding: 0.9rem 0;\n  width: 100%;\n  background: ",";\n  color: #ffffff;\n  font-weight: 800;\n  font-size: 1.1rem;\n  border-radius: 1rem;\n  border: none;\n  box-shadow: 0 2px 8px rgba(40, 96, 96, 0.08);\n  transition: background 0.2s, color 0.2s;\n  cursor: pointer;\n  &:hover {\n    background: ",";\n    color: ",";\n  }\n  &:disabled {\n    background: #e5e7eb;\n    color: #fff;\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n"]);return o=function(){return n},n}function a(){let n=(0,r._)(["\n  background: ",";\n  color: #fff;\n  &:hover {\n    background: ",";\n  }\n"]);return a=function(){return n},n}function l(){let n=(0,r._)(["\n  background: ",";\n  &:hover {\n    background: ",";\n  }\n"]);return l=function(){return n},n}function u(){let n=(0,r._)(["\n  flex: 1 1 0;\n  min-width: 0;\n  max-width: none;\n  border-radius: 0.5rem;\n  padding: 1.2rem 0;\n  font-weight: bold;\n  font-size: 1.1rem;\n  margin: 0 4px;\n  border: none;\n  box-shadow: none;\n  color: ",";\n  background: ",";\n  transition: all 0.2s;\n  &:hover {\n    opacity: 0.92;\n    box-shadow: none;\n  }\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n"]);return u=function(){return n},n}function c(){let n=(0,r._)(["\n  display: flex;\n  flex-direction: row;\n  gap: 8px;\n  width: 100%;\n  justify-content: space-between;\n  align-items: stretch;\n"]);return c=function(){return n},n}let s=i.ZP.button(o(),n=>{let{theme:e}=n;return e.primary},n=>{let{theme:e}=n;return e.primaryDark},n=>{let{theme:e}=n;return e.primaryLight}),d=(0,i.ZP)(s)(a(),n=>{let{theme:e}=n;return e.error},n=>{let{theme:e}=n;return e.primaryDark}),f=(0,i.ZP)(s)(l(),n=>{let{theme:e}=n;return e.primary},n=>{let{theme:e}=n;return e.primaryDark}),m=i.ZP.button(u(),n=>{let{theme:e,$type:t,$selected:r}=n;return r?"#000":"like"===t?e.primary:"neutral"===t?e.neutral:e.dislike},n=>{let{theme:e,$type:t,$selected:r}=n;return r?"like"===t?e.primary:"neutral"===t?e.neutral:e.dislike:e.background});i.ZP.div(c())},3455:function(n,e,t){"use strict";var r=t(2260);function i(){let n=(0,r._)(["\n  background: #fff;\n  border-radius: 1.5rem;\n  box-shadow: none;\n  padding: 2rem 1.5rem;\n  margin-bottom: ",";\n  border: none;\n"]);return i=function(){return n},n}let o=t(8313).ZP.div(i(),n=>{let{marginBottom:e}=n;return e||"2rem"});e.Z=o},618:function(n,e,t){"use strict";t.d(e,{DK:function(){return y},Dx:function(){return v},FN:function(){return j},HN:function(){return P},IK:function(){return E},J7:function(){return k},KH:function(){return C},WD:function(){return _},_1:function(){return Z},h4:function(){return S},u6:function(){return z},vb:function(){return O},vx:function(){return w},y:function(){return N}});var r=t(2260),i=t(8313);function o(){let n=(0,r._)(["\n  font-size: 2rem;\n  color: ",";\n  font-weight: 900;\n"]);return o=function(){return n},n}function a(){let n=(0,r._)(["\n  font-size: 1.1rem;\n  color: ",";\n  font-weight: 600;\n"]);return a=function(){return n},n}function l(){let n=(0,r._)(["\n  font-size: 0.8rem;\n  font-weight: 500;\n  color: ",";\n  background: ",";\n  padding: 0.5rem 1.4rem;\n  border-radius: 1.2rem;\n  min-width: 120px; // ← 원하는 값으로 추가\n  display: inline-block; // width 적용을 위해\n"]);return l=function(){return n},n}function u(){let n=(0,r._)(["\n  height: 100px;\n  width: auto;\n  max-width: 100%;\n  object-fit: contain;\n  @media (max-width: 600px) {\n    height: 48px;\n  }\n"]);return u=function(){return n},n}function c(){let n=(0,r._)(["\n  margin-top: 0.5rem;\n  font-size: 1rem;\n  font-weight: 700;\n  color: #222;\n  opacity: 0.9;\n"]);return c=function(){return n},n}function s(){let n=(0,r._)(["\n  font-weight: 700;\n  font-size: 1.25rem;\n  color: #222;\n  margin-bottom: 1.5rem;\n  line-height: 1.4;\n"]);return s=function(){return n},n}function d(){let n=(0,r._)(["\n  font-size: 0.9rem;\n  color: #3b82f6;\n  font-weight: 600;\n"]);return d=function(){return n},n}function f(){let n=(0,r._)(["\n  font-size: 0.9rem;\n  color: #a3a3a3;\n"]);return f=function(){return n},n}function m(){let n=(0,r._)(["\n  display: inline-block;\n  padding: 0.3rem 1rem;\n  font-size: 0.8rem;\n  font-weight: 600;\n  border-radius: 1rem;\n  background: #dbeafe;\n  color: #2563eb;\n"]);return m=function(){return n},n}function p(){let n=(0,r._)(["\n  display: inline-block;\n  padding: 0.3rem 1rem;\n  font-size: 0.8rem;\n  font-weight: 600;\n  border-radius: 1rem;\n  background: ",";\n  color: ",";\n"]);return p=function(){return n},n}function h(){let n=(0,r._)(["\n  color: #888;\n  font-size: 0.95rem;\n"]);return h=function(){return n},n}function g(){let n=(0,r._)(["\n  color: #a3a3a3;\n  font-size: 0.95rem;\n"]);return g=function(){return n},n}function b(){let n=(0,r._)(["\n  color: #e5e7eb;\n  margin: 0 0.3rem;\n"]);return b=function(){return n},n}function x(){let n=(0,r._)(["\n  color: #ef4444;\n  margin-top: 8px;\n  font-size: 13px;\n"]);return x=function(){return n},n}let v=i.ZP.h1(o(),n=>{let{theme:e}=n;return e.primary}),y=i.ZP.h2(a(),n=>{let{theme:e}=n;return e.primary}),w=i.ZP.span(l(),n=>{let{theme:e}=n;return e.text},n=>{let{theme:e}=n;return e.background}),j=i.ZP.img(u()),k=i.ZP.div(c()),P=i.ZP.div(s()),_=i.ZP.span(d()),O=i.ZP.span(f()),Z=i.ZP.span(m()),S=i.ZP.span(p(),n=>{let{$closed:e}=n;return e?"#fee2e2":"#dcfce7"},n=>{let{$closed:e}=n;return e?"#dc2626":"#16a34a"}),E=i.ZP.span(h()),C=i.ZP.span(g()),z=i.ZP.span(b()),N=i.ZP.div(x())},8896:function(n,e,t){"use strict";var r=t(3586);t.o(r,"usePathname")&&t.d(e,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(e,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(e,{useSearchParams:function(){return r.useSearchParams}})},2260:function(n,e,t){"use strict";function r(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}t.d(e,{_:function(){return r}})},8454:function(n,e,t){"use strict";t.d(e,{w_:function(){return s}});var r=t(4725),i={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},o=r.createContext&&r.createContext(i),a=["attr","size","title"];function l(){return(l=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n}).apply(this,arguments)}function u(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),t.push.apply(t,r)}return t}function c(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?u(Object(t),!0).forEach(function(e){var r,i;r=e,i=t[e],(r=function(n){var e=function(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var r=t.call(n,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:e+""}(r))in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):u(Object(t)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))})}return n}function s(n){return e=>r.createElement(d,l({attr:c({},n.attr)},e),function n(e){return e&&e.map((e,t)=>r.createElement(e.tag,c({key:t},e.attr),n(e.child)))}(n.child))}function d(n){var e=e=>{var t,{attr:i,size:o,title:u}=n,s=function(n,e){if(null==n)return{};var t,r,i=function(n,e){if(null==n)return{};var t={};for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){if(e.indexOf(r)>=0)continue;t[r]=n[r]}return t}(n,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(r=0;r<o.length;r++)t=o[r],!(e.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(n,t)&&(i[t]=n[t])}return i}(n,a),d=o||e.size||"1em";return e.className&&(t=e.className),n.className&&(t=(t?t+" ":"")+n.className),r.createElement("svg",l({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},e.attr,i,s,{className:t,style:c(c({color:n.color||e.color},e.style),n.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),u&&r.createElement("title",null,u),n.children)};return void 0!==o?r.createElement(o.Consumer,null,n=>e(n)):e(i)}}},function(n){n.O(0,[497,313,807,501,361,744],function(){return n(n.s=5900)}),_N_E=n.O()}]);